(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function l(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=l(n);fetch(n.href,a)}})();function Y(){var y=440,f=69,l=null,c=!1,n=null,a=null,u=null,E=null,m,v,q,_,k,A=null,P=2048,x=new Float32Array(P),$=["Do","Do#","Re","Re#","Mi","Fa","Fa#","Sol","Sol#","La","La#","Si"],M=null,I=null;window.onload=function(){l=new AudioContext;var t=new XMLHttpRequest;t.open("GET","./sounds/empty_audio.ogg",!0),t.responseType="arraybuffer",t.onload=function(){l.decodeAudioData(t.response,function(e){u=e})},t.send(),m=document.getElementById("detector"),q=document.getElementById("pitch"),_=document.getElementById("note"),k=document.getElementById("octave"),z(),M=document.querySelector("#start-record"),M.addEventListener("click",function(){M.classList.add("disabled"),K()});const o=function(e){this.$root=document.querySelector(e),this.$pointer=this.$root.querySelector(".neckJS"),this.init()};o.prototype.init=function(){for(var e=0;e<=10;e+=1){const i=document.createElement("div");i.className="meter-scale",i.style.transform="rotate("+(e*9-45)+"deg)",e%5===0&&i.classList.add("meter-scale-strong"),this.$root.querySelector(".neck__wrapper").appendChild(i)}},o.prototype.update=function(e){this.$pointer.style.transform="rotate("+e+"deg)"},I=new o(".meterJS")};function z(){m.ondragenter=function(){return this.classList.add("droptarget"),!1},m.ondragleave=function(){return this.classList.remove("droptarget"),!1},m.ondrop=function(t){this.classList.remove("droptarget"),t.preventDefault(),u=null;var o=new FileReader;return o.onload=function(e){l.decodeAudioData(e.target.result,function(i){u=i},function(){alert("error loading!")})},o.onerror=function(e){alert("Error: "+o.error)},o.readAsArrayBuffer(t.dataTransfer.files[0]),!1}}function G(t,o){for(var e=t.length,i=0,g=.01,p=0,C=e-1,D=.2,s=null,h=0,T=-1,B=-1,d=null,S=null,N=null,b=null,r=0;r<e;r++){var R=t[r];i+=R*R}if(i=Math.sqrt(i/e),i<g)return-1;for(var r=0;r<e/2;r++)if(Math.abs(t[r])<D){p=r;break}for(var r=1;r<e/2;r++)if(Math.abs(t[e-r])<D){C=e-r;break}t=t.slice(p,C),e=t.length,s=new Array(e).fill(0);for(var r=0;r<e;r++)for(var w=0;w<e-r;w++)s[r]=s[r]+t[w]*t[w+r];for(;s[h]>s[h+1];)h++;for(var r=h;r<e;r++)s[r]>T&&(T=s[r],B=r);d=B,S=s[d-1],N=s[d],b=s[d+1];let L,U;return L=(S+b-2*N)/2,U=(b-S)/2,L&&(d=d-U/(2*L)),o/d}function H(){alert("Stream generation failed.")}function O(t,o){try{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia(t,o,H)}catch(e){alert("getUserMedia threw exception :"+e)}}function J(){return c?(n.stop(0),n=null,a=null,c=!1,window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame),window.cancelAnimationFrame(A),"start"):(n=l.createBufferSource(),n.buffer=u,n.loop=!0,a=l.createAnalyser(),a.fftSize=2048,n.connect(a),a.connect(l.destination),n.start(0),c=!0,F(),"stop")}function K(){J(),c&&(n.stop(0),n=null,a=null,c=!1,window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame),window.cancelAnimationFrame(A)),O({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},X)}function X(t){E=l.createMediaStreamSource(t),a=l.createAnalyser(),a.fftSize=2048,E.connect(a),F()}function F(t){new Array,a.getFloatTimeDomainData(x);var o=G(x,l.sampleRate);if(o!=-1){m.className="confident",v=o,q.innerText=Math.round(v);var e=Q(v),i=V(v,e);I.update(i/50*45);var g=null;parseInt(e/12)-1<=8&&parseInt(e/12)-1>=0&&(g=parseInt(e/12)-1);var p=$[e%12];p&&g&&(_.innerHTML=p,k.innerHTML=g)}window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame),A=window.requestAnimationFrame(F)}function Q(t){if(t>16&&t<7903){var o=12*(Math.log(t/y)/Math.log(2));return Math.round(o)+f}}function V(t,o){return Math.floor(1200*Math.log(t/W(o))/Math.log(2))}function W(t){return y*Math.pow(2,(t-f)/12)}}Y();
